<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- mapper为映射的根节点-->
<!-- mapper为映射的根节点，namespace指定Dao接口的完整类名
mybatis会依据这个接口动态创建一个实现类去实现这个接口，
而这个实现类是一个Mapper对象-->
<mapper namespace="com.swpu.cl.mapper.CommentMapper">

<!--    结果集映射-->
    <resultMap id="commentMap" type="comment">
        <id column="comment_id" property="commentId"></id>
        <result column="comment_username" property="commentUsername"></result>
        <result column="comment_msg" property="commentMsg"></result>
        <result column="rating_score" property="ratingScore"></result>
        <result column="create_time" property="createTime"></result>
        <result column="comment_state" property="commentState"></result>

        <collection property="replyList" ofType="reply" column="comment_id" select="com.swpu.cl.mapper.ReplyMapper.findReplyList"/>
    </resultMap>

    <select id="commentList" resultMap="commentMap">
        select `comment`.*
        from `comment`
                 LEFT JOIN product_comment_rel on `comment`.comment_id = product_comment_rel.comment_id
        WHERE product_comment_rel.product_id = #{productId}
    </select>
</mapper>
